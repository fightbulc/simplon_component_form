"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var a=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,l=t.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),u=l&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),f=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,o=(l||f)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(t){var e,n,a,o,i,r;for(e=0<=t.split(",")[0].indexOf("base64")?atob(t.split(",")[1]):decodeURIComponent(t.split(",")[1]),n=new ArrayBuffer(e.length),a=new Uint8Array(n),o=0;o<e.length;o+=1)a[o]=e.charCodeAt(o);return i=t.split(",")[0].split(":")[1].split(";")[0],l?new Blob([u?a:n],{type:i}):((r=new f).append(n),r.getBlob(i))};t.HTMLCanvasElement&&!a.toBlob&&(a.mozGetAsFile?a.toBlob=function(t,e,n){n&&a.toDataURL&&o?t(o(this.toDataURL(e,n))):t(this.mozGetAsFile("blob",e))}:a.toDataURL&&o&&(a.toBlob=function(t,e,n){t(o(this.toDataURL(e,n)))})),"function"==typeof define&&define.amd?define(function(){return o}):t.dataURLtoBlob=o}(window),window.resize=function(){function t(){}return t.prototype={init:function(t){this.outputQuality="undefined"===t?.8:t},photo:function(r,l,u,f,c){var s=this,t=new FileReader;t.onload=function(i){var t=new FileReader;t.onload=function(t){for(var e,n="",a=new Uint8Array(t.target.result).subarray(0,4),o=0;o<a.length;o++)n+=a[o].toString(16);switch(n){case"89504e47":e="image/png";break;case"47494638":e="image/gif";break;case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":e="image/jpeg";break;default:e=r.type}c&&(e=c),s.resize(i.target.result,e,l,u,f)},t.readAsArrayBuffer(r)},t.readAsDataURL(r)},resize:function(t,o,i,r,l){var u=this,f=new Image;f.onload=function(t){var e=document.createElement("canvas"),n=f.width,a=f.height;a<n?i<n&&(a*=i/n,n=i):i<a&&(n*=i/a,a=i),e.width=n,e.height=a,e.getContext("2d").drawImage(f,0,0,n,a),u.output(e,o,r,l)},f.src=t},output:function(t,e,n,a){switch(n){case"file":t.toBlob(function(t){a(t)},e,.8);break;case"dataURL":a(t.toDataURL(e,.8))}}},t}(),function(v){v.fn.imageUpload=function(t){var p=v.extend({getUrlResponseObject:function(t){return t.url}},t),b=new window.resize;b.init();var y=function(t,e,n,a){var o=new FormData;o.append("photo",e),o.append("meta",n);var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&a(i.response)},i.open("POST",t),i.responseType="json",i.send(o)},h=function(t,e,n){var a=v('<div class="form-image-upload-thumbnail"><div class="close-overlay"><a href="#"><i class="remove huge icon"></i>'+n+'</a></div><img data-src=""></div></div>');a.find("img").attr("data-src",e),t.empty().append(a)},m=function(t,e){t.find("span").text(e)};return this.each(function(){var t=v(this).parent(),o=t.find(".button"),e=t.find("input[type=file]"),i=t.find("input[type=hidden]"),r=t.data("upload-url"),l=t.data("upload-meta-data")||null,u=t.data("image-width"),f=t.data("thumb-width")||null,c=v(t.data("thumb-container")),n=t.data("attach-label"),s=t.data("replace-label"),d=t.data("remove-label");""!==i.val()&&h(c,i.val(),d),c.on("click",function(t){t.preventDefault(),c.empty(),m(o,n),i.val("")}),o.on("click",function(t){t.preventDefault(),e.click()}),e.on("change",function(t){t.preventDefault();var e=t.target.files;0<e.length&&o.toggleClass("loading");var n=function(e){y(r,e,l,function(t){i.val(p.getUrlResponseObject(t)),m(o,s),o.hasClass("red")&&o.removeClass("red").addClass("basic"),b.photo(e,f,"dataURL",function(t){h(c,t,d),o.toggleClass("loading")})})};for(var a in e){if("object"!==_typeof(e[a]))return!1;u?b.photo(e[a],u,"file",function(t){n(t)}):n(e[a])}})})}}(jQuery);
//# sourceMappingURL=bundle.min.js.map